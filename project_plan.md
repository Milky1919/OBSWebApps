# OBS用 Webアプリ統合ツール 開発計画書

## 1. プロジェクト概要
OBSのブラウザソースとして読み込むことを想定した、多機能Webアプリ群です。
ルート画面をランチャーとして機能させ、そこから各便利ツール（時計等）へ遷移する構造を持ちます。

## 2. 要件定義

### 基本機能
*   **ルート（ランチャー）画面**: インストールされているアプリ一覧を表示。クリックで該当アプリへ画面遷移。
*   **初期実装アプリ**:
    *   デジタル時計
    *   アナログ時計
*   **OBS連携**: OBS上でスムーズにアプリ切り替えが可能であること。背景透過など、配信画面に馴染むデザインであること。

### 開発・運用要件
*   **独立性**: 各アプリは単独で開発・修正が可能であること。
*   **拡張性**: 新規アプリ追加時に、ルート画面のソースコードを書き換えずに済むこと。
*   **自動化**: アプリを追加した際、ルートの選択肢が自動（または半自動）で増えること。
*   **開発環境**: Dockerを使用し、環境依存を排除する。

## 3. アーキテクチャ提案

### ディレクトリ構成案
```text
/obs-web-tools
  │
  ├── docker-compose.yml  // [Docker] 開発環境定義
  ├── package.json        // [Node.js] 依存パッケージ・スクリプト管理
  │
  ├── index.html          // [ルート] ランチャー本体
  ├── global-manifest.json // [自動生成] 全アプリの情報を集約したファイル
  │
  ├── /scripts
  │    └── update-list.js  // [Node.js] アプリ一覧更新スクリプト
  │
  └── /apps                // 各アプリを格納するディレクトリ
       ├── /digital-clock
       │    ├── index.html // アプリ本体
       │    └── meta.json  // 個別設定
       │
       └── /analog-clock
            ├── index.html
            └── meta.json
```

### 提案するデータ連携フロー
**「ビルドスクリプトによるマニフェスト集約方式」**を採用します。

1.  **個別定義**: 各アプリ開発者は、自分のフォルダ内に `meta.json` を置き、アプリ情報を記述します。
2.  **集約（自動化）**: Node.jsスクリプト（`scripts/update-list.js`）を実行し、`/apps` 内の全 `meta.json` をスキャンして、ルートの `global-manifest.json` を生成します。
3.  **表示**: ルートの `index.html` は `global-manifest.json` を読み込んでボタンを生成します。

## 4. 開発環境構成 (Docker & Node.js)
言語選定は、フロントエンド技術との親和性が高い Node.js を採用します。

### Docker構成イメージ (docker-compose.yml)
ホスト側のファイルをマウントし、コンテナ内で変更検知やコマンド実行を行います。

*   **Base Image**: `node:lts-alpine` (軽量かつ安定)
*   **Volumes**: カレントディレクトリをコンテナ内の作業ディレクトリにマウント。
*   **機能**:
    *   **開発サーバー**: `http-server` などを使い、ローカルブラウザで動作確認できるようにする。
    *   **スクリプト実行**: コンテナ内で `npm run update-list` を実行し、JSONを更新する。

### コマンド運用例
*   `docker compose up`: 開発サーバー起動
*   `docker compose run --rm app npm run build`: アプリ一覧（JSON）の更新を実行

## 5. 実装イメージ

### A. アプリ個別の meta.json 例
```json
{
  "id": "digital-clock",
  "name": "デジタル時計",
  "path": "./apps/digital-clock/index.html",
  "description": "シンプルな現在時刻表示"
}
```

### B. ルート画面 (index.html) の挙動
`fetch('global-manifest.json')` を実行。取得した配列データに基づいてメニューを動的生成。

## 6. OBSでの運用フロー
1.  **セットアップ**: OBSの「ブラウザ」ソースで、ローカルファイルの `obs-web-tools/index.html` を指定。
    *   ※開発中はDockerのローカルサーバーURL (`http://localhost:8080`等) を指定しても良いが、本番運用は静的ファイル読み込みを推奨。
2.  **アプリ切り替え**: OBS上の対話機能やドック機能を利用。

## 7. 今後の進め方
1.  **プロトタイプ作成（React/単一ファイル）**: まずはGemini上で、ランチャーと時計機能を含んだモックアップを作成し、UIや挙動を確認します。
2.  **環境構築（ユーザー様作業）**: Docker環境とファイル構成をローカルに展開し、開発をスタートします。
